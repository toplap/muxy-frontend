(this["webpackJsonpmuxy-frontend"]=this["webpackJsonpmuxy-frontend"]||[]).push([[0],{12:function(e,t,r){},13:function(e,t,r){},14:function(e,t,r){},19:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),c=r(6),o=r.n(c),s=(r(12),r(2)),i=(r(13),r(14),r(0));var l=function(e){var t=e.eventUrl,r=e.startsAt,a=e.endsAt,c=Object(n.useState)(""),o=Object(s.a)(c,2),l=o[0],u=o[1],d=Object(n.useState)(""),j=Object(s.a)(d,2),m=j[0],b=j[1],h=Object(n.useState)(""),p=Object(s.a)(h,2),O=p[0],f=p[1],v=Object(n.useState)(""),y=Object(s.a)(v,2),x=y[0],g=y[1],S=Object(n.useState)(""),C=Object(s.a)(S,2),N=C[0],_=C[1],T=Object(n.useState)(""),H=Object(s.a)(T,2),U=H[0],A=H[1];return Object(i.jsxs)(i.Fragment,{children:[N&&Object(i.jsxs)("div",{children:[Object(i.jsxs)("p",{children:["You have successfully registered for the event. Your streamkey is"," ",Object(i.jsx)("b",{children:N})," "]}),Object(i.jsx)("p",{children:"You should have received this as an email too. "}),Object(i.jsxs)("p",{children:["Save this key well, you will need it for the event and also to delete your slot again."," "]}),Object(i.jsxs)("p",{children:["When this page is reloaded, the key will no longer be displayed."," "]})]}),!N&&Object(i.jsxs)("form",{className:"PerformanceCreateForm",onSubmit:function(e){e.preventDefault(),fetch("".concat("https://muxy.tidalcycles.org","/streams/"),{method:"post",headers:new Headers({Authorization:"Api-Key ".concat("S4b965QU.UuQmHexKmvXjVlFtOSUCWqxDNblqgHaq"),"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify({publisher_name:l,publisher_email:m,title:O,description:x,location:U,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,event:t,starts_at:r,ends_at:a})}).then((function(e){return e.json()})).then((function(e){_(e.key)})).catch(console.error)},children:[Object(i.jsx)("input",{id:"name",type:"text",placeholder:"Name",value:l,onChange:function(e){return u(e.target.value)},required:!0}),Object(i.jsx)("input",{id:"email",type:"text",placeholder:"E-Mail",value:m,onChange:function(e){return b(e.target.value)},required:!0}),Object(i.jsx)("input",{id:"title",type:"text",placeholder:"Title",value:O,onChange:function(e){return f(e.target.value)},required:!0}),Object(i.jsx)("textarea",{id:"description",placeholder:"Description (used for archive videos)",value:x,onChange:function(e){return g(e.target.value)},rows:3,maxLength:1e3}),Object(i.jsx)("input",{id:"location",type:"text",placeholder:"Location",value:U,onChange:function(e){return A(e.target.value)},required:!0}),Object(i.jsx)("input",{type:"submit",className:"card-button",value:"Rave On"})]})]})};var u=function(e){var t=e.streamUrl,r=e.onRemove,a=Object(n.useState)(""),c=Object(s.a)(a,2),o=c[0],l=c[1],u=Object(n.useState)(!1),d=Object(s.a)(u,2),j=d[0],m=d[1];return Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("form",{className:"PerformanceCreateForm",onSubmit:function(e){e.preventDefault(),m(!1);var n=new Headers({Authorization:"Api-Key ".concat("S4b965QU.UuQmHexKmvXjVlFtOSUCWqxDNblqgHaq"),"X-Stream-Key":o,"Content-Type":"application/json",Accept:"application/json"});fetch(t,{method:"DELETE",headers:n}).then((function(e){e.ok?(l(""),r&&r()):m(!0)})).catch((function(e){console.error(e),m(!0)}))},children:[Object(i.jsx)("p",{children:"Enter your streaming key to confirm you want to remove your slot. If you do not remember your streaming key, please contact the event organizer."}),j&&Object(i.jsx)("p",{style:{color:"red"},children:"Something went wrong, did you entered the incorrect stream key? Please try again."}),Object(i.jsx)("input",{id:"key",type:"text",placeholder:"Stream key",value:o,onChange:function(e){return l(e.target.value)},required:!0}),Object(i.jsx)("input",{type:"submit",className:"card-button",value:"Remove slot"})]})})},d=r(3),j=r(5);var m=function(e){var t=e.streamUrl,r=e.currMuxyStream,a=e.onSetInEditMode,c=e.setCurrMuxyStream,o=Object(n.useState)(r.publisher_name),l=Object(s.a)(o,2),u=l[0],d=l[1],m=Object(n.useState)(r.title),b=Object(s.a)(m,2),h=b[0],p=b[1],O=Object(n.useState)(r.description),f=Object(s.a)(O,2),v=f[0],y=f[1],x=Object(n.useState)(""),g=Object(s.a)(x,2),S=g[0],C=g[1],N=Object(n.useState)(r.location),_=Object(s.a)(N,2),T=_[0],H=_[1],U=Object(n.useState)(!1),A=Object(s.a)(U,2),q=A[0],D=A[1];return Object(i.jsx)("div",{className:"PerformanceEditForm",children:Object(i.jsxs)("form",{className:"PerformanceCreateForm",onSubmit:function(e){e.preventDefault(),D(!1);var n=new Headers({Authorization:"Api-Key ".concat("S4b965QU.UuQmHexKmvXjVlFtOSUCWqxDNblqgHaq"),"X-Stream-Key":S,"Content-Type":"application/json",Accept:"application/json"}),o=JSON.stringify({publisher_name:u,title:h,description:v,location:T,ends_at:r.ends_at,starts_at:r.starts_at,event:r.event});fetch(t,{method:"PUT",headers:n,body:o}).then((function(e){e.ok?(C(""),a(!1),c(Object(j.a)(Object(j.a)({},r),{},{publisher_name:u,title:h,description:v,location:T}))):D(!0)})).catch((function(e){console.error(e),D(!0)}))},children:[Object(i.jsx)("p",{children:"Enter your streaming key to confirm you want to edit your slot. If you do not remember your streaming key, please contact the event organizer."}),q&&Object(i.jsx)("p",{style:{color:"red"},children:"Something went wrong, did you entered the incorrect stream key? Please try again."}),Object(i.jsx)("input",{id:"key",type:"text",placeholder:"Stream-Key",value:S,onChange:function(e){return C(e.target.value)},required:!0}),Object(i.jsx)("p",{children:"Here you find your stream information that you can edit. The email address can not displayed for security reasons. If you have problems with your e-mail adress, please contace the event organizer. The information will only be updated if you have entered the correct stream key."}),Object(i.jsx)("input",{id:"name",type:"text",placeholder:"Name",value:u,onChange:function(e){return d(e.target.value)},required:!0}),Object(i.jsx)("input",{id:"title",type:"text",placeholder:"Title",value:h,onChange:function(e){return p(e.target.value)},required:!0}),Object(i.jsx)("textarea",{id:"description",placeholder:"Description (used for archive videos)",value:v,onChange:function(e){return y(e.target.value)},rows:3,maxLength:1e3}),Object(i.jsx)("input",{id:"location",type:"text",placeholder:"Location",value:T,onChange:function(e){return H(e.target.value)},required:!0}),Object(i.jsx)("input",{type:"submit",className:"card-button",value:"Save"})]})})},b=function(e){var t=e.muxyStream,r=e.cycleNo,a=e.eventUrl,c=Object(n.useState)(!1),o=Object(s.a)(c,2),j=o[0],b=o[1],h=Object(n.useState)(t),p=Object(s.a)(h,2),O=p[0],f=p[1],v=Object(n.useState)(!1),y=Object(s.a)(v,2),x=y[0],g=y[1],S=Object(n.useState)(!1),C=Object(s.a)(S,2),N=C[0],_=C[1],T=Object(n.useState)(!1),H=Object(s.a)(T,2),U=H[0],A=H[1],q=d.DateTime.fromISO(t.starts_at).toFormat("HH:mm LLL dd"),D=d.DateTime.fromISO(t.ends_at).toFormat("HH:mm LLL dd"),F=null;"publisher_name"in O&&(F=[O.publisher_name,O.location,O.title,O.timezone].join(" / "));var L=function(){b(!1),g(!1),_(!1)};return Object(i.jsx)("div",{className:"card",children:Object(i.jsxs)("div",{className:"card-body",children:[Object(i.jsxs)("p",{className:"card-header",children:["Cycle #",r]}),Object(i.jsxs)("p",{className:"card-time",children:[q,"-",D," ",!j&&!F&&Object(i.jsx)("button",{className:"card-button-plus",onClick:function(){return b(!0)},children:"+"})]}),U&&Object(i.jsx)("p",{children:"You have removed your slot succesfully."}),j?Object(i.jsx)(l,{eventUrl:a,startsAt:O.starts_at,endsAt:O.ends_at}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("p",{className:"card-text",children:U?"":F||""}),!U&&F&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("button",{onClick:function(){L(),_((function(e){return!e}))},className:"card-button",children:"Edit"}),Object(i.jsx)("button",{onClick:function(){L(),g((function(e){return!e}))},className:"card-button",children:"Remove"}),N&&"url"in O&&Object(i.jsx)(m,{streamUrl:O.url,currMuxyStream:O,onSetInEditMode:_,setCurrMuxyStream:f}),x&&"url"in O&&Object(i.jsx)(u,{streamUrl:O.url,onRemove:function(){return A(!0)}})]})]}),Object(i.jsx)("hr",{})]})})},h=function(e){var t=e.slug,r=e.eventUrl,a=e.startsAt,c=e.endsAt,o=e.setReservedStreamCount,l=e.setTotalStreamCount,u=Object(n.useState)(null),j=Object(s.a)(u,2),m=j[0],h=j[1];Object(n.useEffect)((function(){fetch("".concat("https://muxy.tidalcycles.org","/streams/?event__slug=").concat(t),{method:"get",headers:new Headers({Authorization:"Api-Key ".concat("S4b965QU.UuQmHexKmvXjVlFtOSUCWqxDNblqgHaq")})}).then((function(e){return e.json()})).then((function(e){h(e)})).catch(console.error)}),[t]);var p=Object(n.useMemo)((function(){if(!a||!c)return[];if(!m)return[];for(var e=((null===m||void 0===m?void 0:m.results)||[]).sort((function(e,t){return e.starts_at.localeCompare(t.starts_at)})),t=d.DateTime.fromISO(a),r=d.DateTime.fromISO(c),n=[],o=t,s=function(){var t=o.plus({minutes:15}),r=e.find((function(e){var r=d.DateTime.fromISO(e.starts_at),n=d.DateTime.fromISO(e.ends_at);return o>=r&&t<=n}));r?(n.push(r),o=d.DateTime.fromISO(r.ends_at)):(n.push({starts_at:o.toUTC().toFormat("yyyy-MM-dd'T'HH:mm:ss'Z"),ends_at:t.toUTC().toFormat("yyyy-MM-dd'T'HH:mm:ss'Z")}),o=t)};o<r;)s();return n}),[m]);return o(m?m.results.length:0),l(p?p.length:0),Object(i.jsx)("div",{className:"performance-list",children:p&&p.map((function(e,t){return Object(i.jsx)(b,{eventUrl:r,muxyStream:e,cycleNo:t+1},t)}))})},p=r.p+"static/media/longestnight-sunset-2.0.74a19890.svg",O=r(7),f=r.n(O);var v=function(e){var t=e.event,r=function(e,t){return null===e||null===t?{reserved:0,total:0,percent:0}:{reserved:e,total:t,percent:100*e/t}}(e.reservedStreamCount,e.totalStreamCount);return Object(i.jsxs)("header",{className:"App-header",children:[Object(i.jsx)("img",{src:p,className:"App-logo",alt:"logo"}),Object(i.jsx)("h4",{children:"TOPLAP Presents ..."}),Object(i.jsx)("h1",{children:"TOPLAP20 Live Stream"}),Object(i.jsx)("b",{children:"Note:"})," This is event is not yet open for slot registration. Slot registration opens Monday, Feb 12th.",Object(i.jsxs)("h2",{children:[" ",t&&d.DateTime.fromISO(t.starts_at).toFormat("dd. LLLL HH:mm")," - ",t&&d.DateTime.fromISO(t.ends_at).toFormat("dd. LLLL HH:mm")," ",t&&d.DateTime.fromISO(t.starts_at).toFormat("yyyy")]}),Object(i.jsx)("hr",{}),Object(i.jsx)(f.a,{className:"wrapper",bgColor:"#a9c27c",baseBgColor:"#ffffff",labelClassName:"label",labelAlignment:"outside",width:"100%",height:"28px",margin:"8px",customLabel:"".concat(r.reserved,"/").concat(r.total," slots are filled"),completed:r.percent}),Object(i.jsx)("hr",{}),Object(i.jsxs)("p",{children:["Your timezone: ",Intl.DateTimeFormat().resolvedOptions().timeZone]}),Object(i.jsx)("p",{className:"link-paragraph",children:Object(i.jsxs)("b",{children:["Watch live here >>> ",Object(i.jsx)("a",{href:"https://eulerroom.com",children:"https://eulerroom.com/"})]})})]})};var y=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),r=t[0],a=t[1],c=Object(n.useState)(null),o=Object(s.a)(c,2),l=o[0],u=o[1],d=Object(n.useState)(null),j=Object(s.a)(d,2),m=j[0],b=j[1],p="toplap20";Object(n.useEffect)((function(){fetch("".concat("https://muxy.tidalcycles.org","/events/?slug=").concat(p),{method:"get",headers:new Headers({Authorization:"Api-Key ".concat("S4b965QU.UuQmHexKmvXjVlFtOSUCWqxDNblqgHaq")})}).then((function(e){return e.json()})).then((function(e){a(e)})).catch(console.error)}),[p]);var O=null===r||void 0===r?void 0:r.results[0];return Object(i.jsxs)("main",{className:"App",children:[Object(i.jsx)(v,{event:O,reservedStreamCount:l,totalStreamCount:m}),O&&Object(i.jsx)(h,{slug:O.slug,eventUrl:O.url,startsAt:O.starts_at,endsAt:O.ends_at,setReservedStreamCount:u,setTotalStreamCount:b})]})};var x=function(){return Object(i.jsx)(y,{})};o.a.render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(x,{})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.25c19316.chunk.js.map